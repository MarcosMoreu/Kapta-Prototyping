var planetKey,sentinelKey,firebaseKey,firebaseConfig,cartousername,cartoapiSELECT,isIOS=/iPad|iPhone|iPod|Mac OS X/.test(navigator.userAgent)&&!window.MSStream,isOnline=navigator.onLine,isOnlineGlobal=isOnline,browserLanguage=navigator.language,timeStart=new Date,findFirebaseCredentials=setInterval(function(){if(1==isOnline&null!=firebaseKey)try{firebase.initializeApp(firebaseConfig),clearInterval(findFirebaseCredentials)}catch(e){}},500);"serviceWorker"in navigator&&navigator.serviceWorker.register("./sw.js").then(function(e){e.update(),e.onupdatefound=(()=>{const t=e.installing;t.onstatechange=(()=>{"installed"===t.state&&navigator.serviceWorker.controller&&location.reload()})})}).catch(function(e){});var get=function(e){return new Promise(function(t,n){var o=new XMLHttpRequest;o.onreadystatechange=function(){if(o.readyState===XMLHttpRequest.DONE)if(200===o.status){var e=o.responseText;e=JSON.parse(e),t(e)}else n(o)},o.open("GET",e,!0),o.send()})},tilesDb={getItem:function(e){return localforage.getItem(e)},saveTiles:function(e){for(var t=this,n=[],o=0;o<e.length;o++){!function(e,o){n[e]=new Promise(function(e,n){var l=new XMLHttpRequest;l.open("GET",o.url,!0),l.responseType="blob",l.onreadystatechange=function(){l.readyState===XMLHttpRequest.DONE&&(200===l.status?e(t._saveTile(o.key,l.response)):n({status:l.status,statusText:l.statusText}))},l.send()})}(o,e[o])}return Promise.all(n)},clear:function(){return localforage.clear()},_saveTile:function(e,t){return this._removeItem(e).then(function(){return localforage.setItem(e,t)})},_removeItem:function(e){return localforage.removeItem(e)}};document.getElementById("loginInfo").onclick=function(){window.location.href="pages/tutorial.html"},document.getElementById("loginUnlock").onclick=function(e){e.preventDefault(),document.getElementById("loginUnlock").style.backgroundColor="#D5D6D5",document.getElementById("enteredPw").style.display="initial",document.getElementById("enteredPw").focus(),document.getElementById("login").style.display="initial"};var isFirstTime,lastPositionStoredLOCALLY,requestPw=function(){setTimeout(function(){document.getElementById("modal").style.display="block"},1e3);var e=setInterval(function(){var e=document.getElementById("enteredPw").value;4==e.length&&(document.getElementById("login").style.borderColor="grey",document.getElementById("login").disabled=!1,document.getElementById("login").style.opacity="1"),e.length<4&&(document.getElementById("login").style.borderColor="white",document.getElementById("login").style.opacity="0.3",document.getElementById("login").disabled=!0)},200);document.getElementById("login").onclick=function(t){t.preventDefault(),"2030"==document.getElementById("enteredPw").value?(clearInterval(e),document.getElementById("enteredPw").style.backgroundColor="#39F70F",setTimeout(function(){document.getElementById("modal").style.display="none",document.getElementById("pwForm").style.display="none"},300),localStorage.setItem("pwCorrect",!0)):(document.getElementById("enteredPw").style.backgroundColor="red",document.getElementById("enteredPw").focus(),setTimeout(function(){document.getElementById("enteredPw").style.backgroundColor="white"},300))}},firstLoad=function(){return void 0===window.localStorage||localStorage.getItem("visited")?(isFirstTime=!1,localStorage.getItem("pwCorrect")||requestPw()):(localStorage.setItem("visited",!0),isFirstTime=!0,requestPw()),isFirstTime};window.onload=firstLoad,firstLoad();var created=!1,sameSession=!1;null!=(lastPositionStoredLOCALLY=localStorage.getItem("lastPositionStoredLOCALLY"))&&(lastPositionStoredLOCALLY=lastPositionStoredLOCALLY.split(","));var mappos=L.Permalink.getMapLocation(),urlCoordinates=window.location.href,urlContainsHash=urlCoordinates.includes("#"),southWest=L.latLng(-70,-180),northEast=L.latLng(80,180);if(1==urlContainsHash)var keepOnlyLatLngZoom=urlCoordinates.split("#").pop(),splittedLatLngZoom=keepOnlyLatLngZoom.split(","),urlLat=splittedLatLngZoom[0],urlLng=splittedLatLngZoom[1],urlZoomWithZ=splittedLatLngZoom[2],urlZoom=urlZoomWithZ.replace("z",""),map=L.map("map",{editable:!0,center:[urlLat,urlLng],zoom:urlZoom,minZoom:2,maxZoom:21,zoomControl:!1,attributionControl:!1,maxBounds:L.latLngBounds(southWest,northEast)});else if(null==lastPositionStoredLOCALLY)map=L.map("map",{editable:!0,center:[0,0],zoom:0,minZoom:2,maxZoom:21,zoomControl:!1,attributionControl:!1,maxBounds:L.latLngBounds(southWest,northEast)});else map=L.map("map",{editable:!0,center:[lastPositionStoredLOCALLY[0],lastPositionStoredLOCALLY[1]],zoom:10,minZoom:2,maxZoom:21,zoomControl:!1,attributionControl:!1,maxBounds:L.latLngBounds(southWest,northEast)});L.Permalink.setup(map);var optionsMinimap={position:"topright",width:82,height:82,land:"black",water:"#3B96DD",marker:"white",topojsonSrc:"scripts/lib/leaflet/plugins/leaflet-globeminimap-master/src/world.json"},miniMap=new L.Control.GlobeMiniMap(optionsMinimap);map.addControl(L.control.attribution({position:"bottomright",prefix:"Leaflet"}));var finalLayer,scale=L.control.scale({maxWidth:100,metric:!0,imperial:!1}).addTo(map);function customDeflateMarkers(e){return"Polygon"===e.feature.geometry.type?{icon:L.icon({iconUrl:"images/markerPolygon.png",iconSize:[30,30]})}:"LineString"===e.feature.geometry.type?{icon:L.icon({iconUrl:"images/markerLine.png",iconSize:[30,30]})}:{}}var groupGeoJSON=[],deflated=L.deflate({minSize:100,maxsize:1,markerCluster:!0,markerType:L.marker,markerOptions:customDeflateMarkers});function isJson(e){try{JSON.parse(e)}catch(e){return!1}return!0}if(deflated.addTo(map),0==isFirstTime&null!=localStorage.key(0))for(var i=0,len=localStorage.length;i<len-1;i++){var key=localStorage.key(i),value=localStorage[key],itemFetched=localStorage.getItem(key);if(isJson(itemFetched),1==isJson(itemFetched)){var getItemToJSON=JSON.parse(itemFetched);isJson(getItemToJSON),groupGeoJSON[i]=getItemToJSON}else groupGeoJSON[i]={}}var markerIconLocalStorage=new L.icon({iconUrl:"images/markerLocalStorage.png",iconSize:[22,33],iconAnchor:[11,0]});if(0==isJson(groupGeoJSON)&&0==isFirstTime)var localStorageLayer=L.geoJSON(groupGeoJSON,{style:function(e){return e.properties&&e.properties.style},pointToLayer:function(e,t){return L.marker(t,{icon:markerIconLocalStorage,draggable:!1})},color:"#33FFFF",onEachFeature:onEachFeatureAudioLocalStorage,autopan:!1});var cartoIdFeatureSelected,cartoLoaded,clickCountDelete,clusters=L.markerClusterGroup({animate:!0,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,animateAddingMarkers:!0}),cartoGeometries=null,selectedFeature=null,featureType=null,filterIsOn=!1,template=document.getElementById("popup"),cartoGeoJSONLayer=function(e){cartoLoaded=!0,cartoGeometries=L.geoJson(e,{cache:!1,color:"#AFFDA7",onEachFeature:function(e,t){e.properties.audioavailable;"Point"==e.geometry.type&&t.bindPopup(template,{minWidth:200}),"Polygon"==e.geometry.type&&t.bindPopup(template,{minWidth:200}),"LineString"==e.geometry.type&&t.bindPopup(template,{minWidth:200}),t.on("click",function(n){if(document.getElementById("clearFilter").style.display="none",document.getElementById("applyFilter").style.display="none",document.getElementById("filterByDate").style.display="none",document.getElementById("classification").style.display="none",document.getElementById("emoji").style.display="none",document.getElementById("whatsApp").style.display="none",document.getElementById("telegram").style.display="none",document.getElementById("weChat").style.display="none",document.getElementById("goBackMessagingApps").style.display="none",myLayer_Button.removeFrom(map),filter_Button.removeFrom(map),googleSat_Button.removeFrom(map),osm_Button.removeFrom(map),planet_Button.removeFrom(map),miniMap.addTo(map),!n.target.defaultOptions&&"Point"!=n.target.feature.properties.areapolygon&&"Point"!=n.target.feature.properties.lengthline){map.closePopup();map.getZoom();var o=n.target.feature.properties.geometrystring,l=L.geoJSON(JSON.parse(o));console.log(l),map.fitBounds(l.getBounds())}if("Point"==n.target.feature.geometry.type&&map.getZoom()<15&&"Point"==n.target.feature.properties.areapolygon&&"Point"==n.target.feature.properties.lengthline){map.closePopup();o=n.target.feature.properties.geometrystring,l=L.geoJSON(JSON.parse(o));var a=n.target.feature.geometry.coordinates,i=L.GeoJSON.coordsToLatLng(a);map.setView(i,15),t.closePopup(e.properties.landusesemoji+e.properties.audioavailable)}else"Point"!=(selectedFeature=n.target).feature.geometry.type&&("Polygon"==selectedFeature.feature.geometry.type?(document.getElementById("popupAreaLength").style.display="initial",document.getElementById("popupAreaLength").textContent=e.properties.areapolygon,"."!=selectedFeature.feature.properties.audioavailable?(document.getElementById("commentPopup").disabled=!1,document.getElementById("commentPopup").onclick=function(){window.location.href=e.properties.audioavailable,document.getElementById("commentPopup").disabled=!0},document.getElementById("commentPopup").style.display="initial",document.getElementById("commentPopup").textContent="ðŸ”Š "+e.properties.landusesemoji):(document.getElementById("commentPopup").style.display="initial",document.getElementById("commentPopup").textContent=e.properties.landusesemoji)):(document.getElementById("popupAreaLength").style.display="none","."!=selectedFeature.feature.properties.audioavailable?(document.getElementById("commentPopup").disabled=!1,document.getElementById("commentPopup").onclick=function(){window.location.href=e.properties.audioavailable,document.getElementById("commentPopup").disabled=!0},document.getElementById("commentPopup").style.display="initial",document.getElementById("commentPopup").textContent="ðŸ”Š "+e.properties.landusesemoji):(document.getElementById("commentPopup").style.display="initial",document.getElementById("commentPopup").textContent=e.properties.landusesemoji)),document.getElementById("editDeletePopup").style.display="initial",document.getElementById("backDeleteFeature").style.display="initial",document.getElementById("shareMessagingApp").style.display="initial",document.getElementById("deleteFeature").style.display="initial",document.getElementById("deleteFeature").style.opacity="1",document.getElementById("deleteFeature").disabled=!1,document.getElementById("randomSuggestion").style.display="initial",miniMap.addTo(map),gps_Button.button.style.opacity="0.4",gps_Button.button.disabled=!0,document.getElementById("tutorial").style.display="none",document.getElementById("polygon").style.display="none",document.getElementById("polyline").style.display="none",document.getElementById("point").style.display="none",selectedFeature.setStyle({color:"#F70573"})),"Point"==selectedFeature.feature.geometry.type&&map.getZoom()>=15&&"Point"==n.target.feature.properties.areapolygon&&"Point"==n.target.feature.properties.lengthline&&(document.getElementById("popupAreaLength").style.display="none","."!=selectedFeature.feature.properties.audioavailable?(document.getElementById("commentPopup").disabled=!1,document.getElementById("commentPopup").onclick=function(){window.location.href=e.properties.audioavailable,document.getElementById("commentPopup").disabled=!0},document.getElementById("commentPopup").style.display="initial",document.getElementById("commentPopup").textContent="ðŸ”Š "+e.properties.landusesemoji):(document.getElementById("commentPopup").style.display="initial",document.getElementById("commentPopup").textContent=e.properties.landusesemoji),document.getElementById("editDeletePopup").style.display="initial",document.getElementById("backDeleteFeature").style.display="initial",document.getElementById("shareMessagingApp").style.display="initial",document.getElementById("deleteFeature").style.display="initial",document.getElementById("deleteFeature").style.opacity="1",document.getElementById("deleteFeature").disabled=!1,document.getElementById("randomSuggestion").style.display="initial",miniMap.addTo(map),gps_Button.button.style.opacity="0.4",gps_Button.button.disabled=!0,document.getElementById("tutorial").style.display="none",document.getElementById("polygon").style.display="none",document.getElementById("polyline").style.display="none",document.getElementById("point").style.display="none",selectedFeature.editing.enable()),map.on("zoomend",function(e){try{deflated.editing.disable()}catch(e){}clickCountDeleteButton=0,map.closePopup(),selectedFeature&&null!=selectedFeature&&document.getElementById("backDeleteFeature").click()}),map.on("moveend",function(e){try{deflated.editing.disable()}catch(e){}clickCountDeleteButton=0,map.closePopup(),selectedFeature&&null!=selectedFeature&&document.getElementById("backDeleteFeature").click()}),cartoIdFeatureSelected=selectedFeature.feature.properties.cartodb_id})}});try{cartoGeometries.addTo(deflated)}catch(e){console.log("error sql catched due to empty layer after filter applied")}return cartoGeometries};if(1==isOnline){function getGeoJSON(){return $.getJSON({cache:!1,success:cartoGeoJSONLayer,url:"https://"+cartousername+".cartodb.com/api/v2/sql?format=GeoJSON&q="+sqlQuery+cartoapiSELECT}),cartoLoaded&&cartoIdFeatureSelected&&selectedFeature&&cartoGeometries}sqlQuery="SELECT * FROM lumblu"}var findCartoCredential=setInterval(function(){return 1==isOnline&&null!=cartousername&&(clearInterval(findCartoCredential),getGeoJSON()),cartousername},100),submitToProxy=function(e){$.post("./callProxy.php",{qurl:e,cache:!1,timeStamp:(new Date).getTime()},function(e){})};function setData(){if(null!=cartoIdFeatureSelected&&0==created){var e="DELETE FROM lumblu WHERE cartodb_id='"+cartoIdFeatureSelected+"'";cartoIdFeatureSelected=null}else{dataGeometry=data.features[0].geometry;var t=JSON.stringify(dataGeometry);e="INSERT INTO lumblu (the_geom, datetime, randomid, landuses, landusesemoji, audioavailable, areapolygon, lengthline, timespent, distance, geometrystring) VALUES (ST_SetSRID(ST_GeomFromGeoJSON('"+t+("'),4326),'"+dateTime+"','"+randomID+"','"+landUses+"','"+landUsesEmoji+"','"+audioAvailable+"','"+areaPolygon+"','"+lengthLine+"','"+timeSpendSeconds+"','"+dist_m_Participant_Feature+"','"+t+"')")}submitToProxy(e)}var initialScreen=!0,clickCountDeleteButton=0;document.getElementById("backDeleteFeature").onclick=function(){try{document.getElementById("popupAreaLength").disabled=!0,document.getElementById("commentPopup").disabled=!0}catch(e){}map.touchZoom.enable(),map.doubleClickZoom.enable(),map.scrollWheelZoom.enable(),map.dragging.enable(),osm_Button.addTo(map),googleSat_Button.removeFrom(map),planet_Button.removeFrom(map),myLayer_Button.addTo(map),filter_Button.addTo(map),miniMap.remove(),gps_Button.button.style.opacity="1",gps_Button.button.disabled=!1;try{"Point"!=selectedFeature.feature.geometry.type&&selectedFeature.setStyle({color:"#AFFDA7"}),selectedFeature.editing.disable()}catch(e){}return map.closePopup(),selectedFeature=null,clickCountDeleteButton=0,cartoIdFeatureSelected=null,document.getElementById("tutorial").style.display="initial",document.getElementById("polygon").style.display="initial",document.getElementById("polyline").style.display="initial",document.getElementById("point").style.display="initial",document.getElementById("backDeleteFeature").style.display="none",document.getElementById("deleteFeature").style.display="none",document.getElementById("deleteFeature").style.backgroundColor="white",document.getElementById("deleteFeature").style.borderColor="white",document.getElementById("imageDeleteFeature").src="images/binpre.png",document.getElementById("shareMessagingApp").style.opacity="1",document.getElementById("shareMessagingApp").disabled=!1,document.getElementById("randomSuggestion").style.opacity="1",document.getElementById("randomSuggestion").disabled=!1,document.getElementById("shareMessagingApp").style.display="none",document.getElementById("randomSuggestion").style.display="none",miniMap.remove(),selectedFeature&&clickCountDeleteButton&&cartoIdFeatureSelected},document.getElementById("shareMessagingApp").onclick=function(){document.getElementById("backDeleteFeature").style.display="none",document.getElementById("shareMessagingApp").style.display="none",document.getElementById("deleteFeature").style.display="none",document.getElementById("randomSuggestion").style.display="none",document.getElementById("whatsApp").style.display="initial",document.getElementById("telegram").style.display="initial",document.getElementById("weChat").style.display="initial",document.getElementById("goBackMessagingApps").style.display="initial"},document.getElementById("goBackMessagingApps").onclick=function(){document.getElementById("whatsApp").style.display="none",document.getElementById("telegram").style.display="none",document.getElementById("weChat").style.display="none",document.getElementById("goBackMessagingApps").style.display="none",document.getElementById("backDeleteFeature").style.display="initial",document.getElementById("shareMessagingApp").style.display="initial",document.getElementById("deleteFeature").style.display="initial",document.getElementById("deleteFeature").style.backgroundColor="white",document.getElementById("deleteFeature").style.borderColor="white",document.getElementById("imageDeleteFeature").src="images/binpre.png",document.getElementById("randomSuggestion").style.display="initial"},document.getElementById("whatsApp").onclick=function(){window.location.href="https://wa.me/?text="+encodeURIComponent(window.location.href)},document.getElementById("telegram").onclick=function(){window.location.href="https://telegram.me/?text="+encodeURIComponent(window.location.href)},document.getElementById("weChat").onclick=function(){window.location.href="weixin://?text="+encodeURIComponent(window.location.href)},document.getElementById("editDeletePopup").onclick=function(){document.getElementById("editDeletePopup").style.display="none",document.getElementById("backDeleteFeature").style.display="none",document.getElementById("shareMessagingApp").style.display="none",document.getElementById("deleteFeature").style.display="none",document.getElementById("randomSuggestion").style.display="none",gps_Button.button.style.opacity="0.4",gps_Button.button.disabled=!0,document.getElementById("deleteInPopUp").style.display="initial",document.getElementById("toCommentPopup").style.display="initial",document.getElementById("backEditDelete").style.display="initial",document.getElementById("classification").style.display="initial",document.getElementById("emoji").style.display="initial",document.getElementById("emoji").disabled=!0,document.getElementById("emoji").style.opacity="0.4",document.getElementById("noAudioIOS").style.display="initial",document.getElementById("noAudioIOS").disabled=!0,document.getElementById("noAudioIOS").style.opacity="0.4",document.getElementById("share-download").style.display="initial",document.getElementById("share-download").disabled=!0,document.getElementById("share-download").style.opacity="0.4";try{document.getElementById("popupAreaLength").disabled=!1,document.getElementById("commentPopup").disabled=!1}catch(e){}map.dragging.disable(),map.touchZoom.disable(),map.doubleClickZoom.disable(),map.scrollWheelZoom.disable(),map.on("click",function(e){try{document.getElementById("deleteInPopUp").style.display="none",document.getElementById("toCommentPopup").style.display="none"}catch(e){}})},document.getElementById("backEditDelete").onclick=function(){document.getElementById("deleteFeature").style.backgroundColor="white",document.getElementById("deleteFeature").style.borderColor="white",document.getElementById("imageDeleteFeature").src="images/binpre.png",document.getElementById("shareMessagingApp").style.opacity="1",document.getElementById("shareMessagingApp").disabled=!1,document.getElementById("randomSuggestion").style.opacity="1",document.getElementById("randomSuggestion").disabled=!1,document.getElementById("shareMessagingApp").style.display="none",document.getElementById("randomSuggestion").style.display="none",clickCountDeleteButton=0;try{document.getElementById("editDeletePopup").style.display="initial",document.getElementById("deleteInPopUp").style.display="none",document.getElementById("toCommentPopup").style.display="none",document.getElementById("imageDeleteInPopup").style.background="white"}catch(e){}document.getElementById("backEditDelete").style.display="none",gps_Button.button.style.opacity="1",gps_Button.button.disabled=!1,document.getElementById("classification").style.display="none",document.getElementById("emoji").style.display="none",document.getElementById("emoji").disabled=!1,document.getElementById("emoji").opacity="1",document.getElementById("noAudioIOS").style.display="none",document.getElementById("noAudioIOS").disabled=!1,document.getElementById("noAudioIOS").opacity="1",document.getElementById("share-download").style.display="none",document.getElementById("share-download").disabled=!1,document.getElementById("share-download").opacity="1",document.getElementById("deleteFeature").style.display="none",document.getElementById("tutorial").style.display="initial",document.getElementById("polygon").style.display="initial",document.getElementById("polyline").style.display="initial",document.getElementById("point").style.display="initial";try{document.getElementById("popupAreaLength").disabled=!0,document.getElementById("commentPopup").disabled=!0}catch(e){}try{"Point"!=selectedFeature.feature.geometry.type&&selectedFeature.setStyle({color:"#AFFDA7"}),selectedFeature.editing.disable()}catch(e){}return osm_Button.addTo(map),googleSat_Button.removeFrom(map),planet_Button.removeFrom(map),myLayer_Button.addTo(map),filter_Button.addTo(map),map.closePopup(),miniMap.remove(),map.dragging.enable(),map.touchZoom.enable(),map.doubleClickZoom.enable(),map.scrollWheelZoom.enable(),(selectedFeature=null)&&clickCountDeleteButton},document.getElementById("randomSuggestion").onclick=function(){document.getElementById("randomSuggestion").style.backgroundColor="yellow",document.getElementById("randomSuggestion").style.borderColor="yellow",document.getElementById("deleteFeature").style.opacity="0.4",document.getElementById("deleteFeature").disabled=!0,document.getElementById("imageDeleteFeature").src="images/binpre.png",setTimeout(function(){document.getElementById("randomSuggestion").style.backgroundColor="#3B96DD",document.getElementById("randomSuggestion").style.borderColor="#3B96DD"},500),document.getElementById("imageryAlert").style.display="initial",setTimeout(function(){document.getElementById("imageryAlert").style.display="none"},1e4);deflated._layers.length,deflated._layers.length;var e=[[51.477965,-.001467],[-215e-6,37.070231],[13.597167,-88.837874],[35.956888,-5.604401],[41.511377,-.001191],[78.236011,15.491409],[27.988129,86.924973],[34.391822,132.452095],[46.234107,6.055736],[.010986,-.003605],[-30.31276,149.565484]][Math.trunc(11*Math.random())];console.log(e),map.setView(e,15),document.getElementById("backDeleteFeature").style.display="initial",document.getElementById("shareMessagingApp").style.display="initial",document.getElementById("deleteFeature").style.display="initial",document.getElementById("randomSuggestion").style.display="initial",miniMap.addTo(map),osm_Button.removeFrom(map),googleSat_Button.removeFrom(map),planet_Button.removeFrom(map),myLayer_Button.removeFrom(map),filter_Button.removeFrom(map),document.getElementById("tutorial").style.display="none",document.getElementById("polygon").style.display="none",document.getElementById("polyline").style.display="none",document.getElementById("point").style.display="none"},document.getElementById("deleteFeature").onclick=function(){return map.touchZoom.enable(),map.doubleClickZoom.enable(),map.scrollWheelZoom.enable(),map.dragging.enable(),0==clickCountDeleteButton?(document.getElementById("deleteFeature").style.backgroundColor="red",document.getElementById("deleteFeature").style.borderColor="black",document.getElementById("imageDeleteFeature").src="images/binpost.png",document.getElementById("shareMessagingApp").style.opacity="0.4",document.getElementById("shareMessagingApp").disabled=!0,document.getElementById("randomSuggestion").style.opacity="0.4",document.getElementById("randomSuggestion").disabled=!0,clickCountDeleteButton=1):(clickCountDeleteButton=0,myLayer_Button.button.style.opacity="1",myLayer_Button.button.disabled=!1,filter_Button.button.style.opacity="1",filter_Button.button.disabled=!1,document.getElementById("tutorial").style.display="initial",document.getElementById("polygon").style.display="initial",document.getElementById("polyline").style.display="initial",document.getElementById("point").style.display="initial",miniMap.remove(),document.getElementById("backDeleteFeature").style.display="none",document.getElementById("deleteFeature").style.display="none",document.getElementById("deleteFeature").style.backgroundColor="white",document.getElementById("deleteFeature").style.borderColor="white",document.getElementById("imageDeleteFeature").src="images/binpre.png",document.getElementById("shareMessagingApp").style.opacity="1",document.getElementById("shareMessagingApp").disabled=!1,document.getElementById("randomSuggestion").style.opacity="1",document.getElementById("randomSuggestion").disabled=!1,document.getElementById("shareMessagingApp").style.display="none",document.getElementById("randomSuggestion").style.display="none",deflated.removeLayer(selectedFeature),selectedFeature=null,setData()),selectedFeature&&clickCountDeleteButton&&clickCountDelete};var googleSat=L.tileLayer.offline("https://mt.google.com/vt/lyrs=s,h&x={x}&y={y}&z={z}",tilesDb,{minZoom:2,maxZoom:21,maxNativeZoom:21,subdomains:["mt0","mt1","mt2","mt3"],attribution:"Google Imagery"}).addTo(map),osm=L.tileLayer.offline("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",tilesDb,{minZoom:2,maxZoom:21,maxNativeZoom:21,attribution:"OpenStreetMap Contributors"}),offlineControlGoogle=L.control.offline(googleSat,tilesDb,{saveButtonHtml:'<img src="images/download.png" width=15px ; height=15px>',removeButtonHtml:'<img src="images/bin.png" width=15px ; height=15px>',confirmSavingCallback:function(e,t){window.confirm("Save "+e+"?")&&t()},confirmRemovalCallback:function(e){window.confirm("Remove all the tiles?")&&e()},minZoom:0,maxZoom:19}),offlineControlOSM=L.control.offline(osm,tilesDb,{saveButtonHtml:'<img src="images/download.png" width=15px ; height=15px>',removeButtonHtml:'<img src="images/bin.png" width=15px ; height=15px>',confirmSavingCallback:function(e,t){window.confirm("Save "+e+"?")&&t()},confirmRemovalCallback:function(e){window.confirm("Remove all the tiles?")&&e()},minZoom:0,maxZoom:19}),clickButtonCount=0;if(1==isIOS)var iconGPS='<img src="images/gps.png" width=40px; height=40px; style="margin-left:-5px" > ',iconOSM='<img src="images/osm.png" width=40px; height=40px; style="margin-left:-5px" > ',iconGOOGLE='<img src="images/google.png" width=40px; height=40px; style="margin-left:-5px" > ',iconPLANET='<img src="images/planet.png" width=40px; height=40px; style="margin-left:-5px" > ',iconLAYERS='<img src="images/myLayer.png" width=40px; height=40px; style="margin-left:-5px" > ',iconFILTER='<img src="images/filterIcon.png" width=40px; height=40px; style="margin-left:-5px" > ',iconRANDOM='<img src="images/gps.png" width=40px; height=40px; style="margin-left:-5px" > ';else iconGPS='<img src="images/gps.png" width=40px; height=40px; style="margin-left:-1px" > ',iconOSM='<img src="images/osm.png" width=40px; height=40px; style="margin-left:-1px" > ',iconGOOGLE='<img src="images/google.png" width=40px; height=40px; style="margin-left:-1px"> ',iconPLANET='<img src="images/planet.png" width=40px; height=40px; style="margin-left:-1px"> ',iconLAYERS='<img src="images/myLayer.png" width=40px; height=40px; style="margin-left:-1px"> ',iconFILTER='<img src="images/filterIcon.png" width=40px; height=40px; style="margin-left:-1px" > ',iconRANDOM='<img src="images/gps.png" width=40px; height=40px; style="margin-left:-1px" > ';var osm_Button=L.easyButton({id:"osm",class:"easyButton",position:"topright",states:[{icon:iconOSM,stateName:"check-mark",onClick:function(e,t){return clickButtonCount+=1,document.getElementById("imageryAlert").style.display="none",t.options.maxZoom=19,t.options.minZoom=2,osm_Button.removeFrom(t),planet_Button.addTo(t),myLayer_Button.addTo(t),1==isOnline&&filter_Button.addTo(t),10==clickButtonCount?(offlineControlOSM.addTo(t),clickButtonCount=0):(osm.addTo(t),googleSat.removeFrom(t)),clickButtonCount}}]});osm_Button.button.style.width="50px",osm_Button.button.style.height="50px",osm_Button.addTo(map);var googleSat_Button=L.easyButton({id:"googleSat",class:"easyButton1",position:"topright",states:[{icon:iconGOOGLE,onClick:function(e,t){return clickButtonCount+=1,document.getElementById("imageryAlert").style.display="none",t.options.maxZoom=21,t.options.minZoom=2,googleSat_Button.removeFrom(t),osm_Button.addTo(t),myLayer_Button.addTo(t),1==isOnline&&filter_Button.addTo(t),15==clickButtonCount?(offlineControlGoogle.addTo(t),clickButtonCount=0):(googleSat.addTo(t),wmsSentinel2.removeFrom(t),planet.removeFrom(t),osm.removeFrom(t)),clickButtonCount}}]});googleSat_Button.button.style.width="50px",googleSat_Button.button.style.height="50px",googleSat_Button.button.style.transitionDuration=".3s",googleSat_Button.button.style.backgroundColor="black";var planet_Button=L.easyButton({id:"planet",class:"easyButton",position:"topright",states:[{icon:iconPLANET,stateName:"check-mark",onClick:function(e,t){var n=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200411_104056_53_105e/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),o=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200411_104054_50_105e/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),l=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200402_080331_1043/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),a=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200402_080330_1043/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),i=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200402_080329_1043/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),d=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200306_073616_1011/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),r=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200306_073615_1011/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),s=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200416_083425_1018/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),m=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200403_105241_78_1064/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),y=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200403_105239_76_1064/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),c=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200410_083657_42_1065/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"],attribution:"Planet/Sentinel Imagery MAY-JULY 2020"}),u=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200410_074244_1018/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),p=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200410_074243_1018/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),g=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200411_104513_103d/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),B=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200411_104512_103d/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),I=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200411_104511_103d/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),E=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200715_093554_1032/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),f=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200730_093028_101b/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]}),b=L.tileLayer("https://{s}.planet.com/data/v1/PSScene4Band/20200730_091658_1040/{z}/{x}/{y}.png?api_key="+planetKey,{maxZoom:18,maxNativeZoom:20,subdomains:["tiles0","tiles1","tiles2","tiles3"]});planet=L.layerGroup([n,o,l,a,i,d,r,s,m,y,c,u,p,g,B,I,E,f,b]),wmsSentinel2=L.tileLayer.wms("https://services.sentinel-hub.com/ogc/wms/"+sentinelKey+"?REQUEST=GetMap&PREVIEW=2",{layers:"P4"}),clickButtonCount=0,t.options.maxZoom=18,t.options.minZoom=2,planet_Button.removeFrom(t),googleSat_Button.addTo(t),wmsSentinel2.addTo(t),planet.addTo(t),googleSat.removeFrom(t),osm.removeFrom(t),myLayer_Button.addTo(t),1==isOnline&&filter_Button.addTo(t)}}]});planet_Button.button.style.width="50px",planet_Button.button.style.height="50px",planet_Button.button.style.transitionDuration=".3s";var featureSent,filterApplied,myLayerIsOn=!0,whichLayerIsOn="deflated",myLayer_Button=L.easyButton({id:"myLayerButton",class:"easyButton",position:"topright",states:[{icon:iconLAYERS,stateName:"check-mark",onClick:function(e,t){"deflated"==whichLayerIsOn&&null!=localStorageLayer?(deflated.removeFrom(t),null!=localStorageLayer&&localStorageLayer.addTo(t),null!=finalLayer&&finalLayer.addTo(t),whichLayerIsOn="localStorage",myLayer_Button.button.style.backgroundColor="white",filter_Button.button.style.opacity="0.4",filter_Button.button.disabled=!0):"deflated"==whichLayerIsOn&&null==localStorageLayer?(whichLayerIsOn="none",deflated.removeFrom(t),myLayer_Button.button.style.backgroundColor="grey"):"localStorage"==whichLayerIsOn?(null!=localStorageLayer&&localStorageLayer.removeFrom(t),whichLayerIsOn="none",null!=finalLayer&&finalLayer.removeFrom(t),myLayer_Button.button.style.backgroundColor="grey",filter_Button.button.style.opacity="0.4",filter_Button.button.disabled=!0):"none"==whichLayerIsOn&&(whichLayerIsOn="deflated",null!=finalLayer&&finalLayer.removeFrom(t),1==featureSent?(sqlQuery="SELECT * FROM lumblu ORDER BY cartodb_id DESC LIMIT 1",getGeoJSON(),deflated.addTo(t),featureSent=!1):deflated.addTo(t),myLayer_Button.button.style.backgroundColor="black",filter_Button.button.style.opacity="1",filter_Button.button.disabled=!1)}}]}).addTo(map);myLayer_Button.button.style.width="50px",myLayer_Button.button.style.height="50px",myLayer_Button.button.style.transitionDuration=".3s",myLayer_Button.button.style.backgroundColor="black";var dateFilterValue,filter_Button=L.easyButton({id:"filter",position:"topright",states:[{icon:iconFILTER,stateName:"check-mark",onClick:function(e,t){0==filterIsOn?(filterIsOn=!0,myLayer_Button.button.style.opacity="0.4",myLayer_Button.button.disabled=!0,filter_Button.button.style.backgroundColor="white",document.getElementById("tutorial").style.display="none",document.getElementById("polygon").style.display="none",document.getElementById("polyline").style.display="none",document.getElementById("point").style.display="none",document.getElementById("clearFilter").style.display="initial",document.getElementById("applyFilter").style.display="initial",document.getElementById("filterByDate").style.display="initial",document.getElementById("classification").style.display="initial",document.getElementById("emoji").style.display="initial",document.getElementById("emoji").disabled=!1,document.getElementById("emoji").style.opacity="1"):1==filterIsOn&&(filterIsOn=!1,myLayer_Button.button.style.opacity="1",myLayer_Button.button.disabled=!1,filter_Button.button.style.opacity="1",filter_Button.button.disabled=!1,filter_Button.button.style.backgroundColor=1==filterApplied?"green":"black",document.getElementById("tutorial").style.display="initial",document.getElementById("polygon").style.display="initial",document.getElementById("polyline").style.display="initial",document.getElementById("point").style.display="initial",document.getElementById("clearFilter").style.display="none",document.getElementById("applyFilter").style.display="none",document.getElementById("filterByDate").style.display="none",document.getElementById("classification").style.display="none",document.getElementById("emoji").style.display="none")}}]}).addTo(map);1==isOnline&&filter_Button.addTo(map),filter_Button.button.style.width="50px",filter_Button.button.style.height="50px",filter_Button.button.style.transitionDuration=".3s",filter_Button.button.style.backgroundColor="black",document.getElementById("applyFilter").onclick=function(e){document.getElementById("alertApplyFilter").style.display="initial",setTimeout(function(){document.getElementById("alertApplyFilter").style.display="none"},5e3),boxContentFiltering=document.getElementById("emojionearea").value;try{deflated.clearLayers()}catch(e){console.log("error sql catched due to empty layer after filter applied")}var t=boxContentFiltering+"'";return sqlQuery="SELECT * FROM lumblu WHERE landusesemoji LIKE '"+t,getGeoJSON(),filterApplied=!0},document.getElementById("clearFilter").onclick=function(e){document.getElementsByClassName("emojionearea-editor")[0].innerHTML=null;try{deflated.clearLayers()}catch(e){console.log("error sql catched due to empty layer after filter applied  ")}return sqlQuery="SELECT * FROM lumblu",getGeoJSON(),filterApplied=!1},document.getElementById("filterByDate").onclick=function(e){var t=document.getElementById("imgFilterByDate");return t.src.match("dateAll")?(t.src="images/dateYear.png",dateFilterValue="Year",document.getElementById("alertFilterDate").style.display="initial",setTimeout(function(){document.getElementById("alertFilterDate").style.display="none"},5e3)):t.src.match("dateYear")?(t.src="images/dateMonth.png",dateFilterValue="Month"):t.src.match("dateMonth")?(t.src="images/dateWeek.png",dateFilterValue="Week"):t.src.match("dateWeek")?(t.src="images/dateDay.png",dateFilterValue="Day"):t.src.match("dateDay")&&(t.src="images/dateAll.png",dateFilterValue="All"),dateFilterValue};var gpsIcon=L.icon({iconUrl:"images/man.png",iconSize:[30,30],iconAnchor:[20,40]}),currentLocation=[],accuracy=0,markerAdded=!1;function findBuffer(e){var t=e.coords.latitude,n=e.coords.longitude;return accuracy=e.coords.accuracy,0==markerAdded&&(markerAdded=!0),(currentLocation=[t,n])&markerAdded&accuracy}var circleGT250,circleLT250,locationFound=!1,audioRecorded=!1,circleLT250Added=!1,circleGT250Added=!1,refreshGPSbutton=setInterval(function(){if(localStorage.getItem("pwCorrect")){try{navigator.geolocation.watchPosition(findBuffer)}catch(e){}if(null!=currentLocation[0]){if(localStorage.setItem("lastPositionStoredLOCALLY",currentLocation),locationFound=!0,accuracy<=50)gps_Button.button.style.backgroundColor="green",clearInterval(refreshGPSbutton),L.marker(currentLocation,{icon:gpsIcon,draggable:!1}).addTo(map);else if(accuracy>50&&accuracy<=250){gps_Button.button.style.backgroundColor="yellow";try{navigator.geolocation.watchPosition(findBuffer)}catch(e){}0==circleLT250Added&&(circleLT250=L.circle(currentLocation,{color:"#ffffff00",fillColor:"yellow",fillOpacity:.3,radius:accuracy}),circleLT250Added=!0)}else if(accuracy>250){gps_Button.button.style.backgroundColor="orange";try{navigator.geolocation.watchPosition(findBuffer)}catch(e){}0==circleGT250Added&&(circleGT250=L.circle(currentLocation,{color:"#ffffff00",fillColor:"orange",fillOpacity:.3,radius:accuracy}),circleGT250Added=!0)}}else{gps_Button.button.style.backgroundColor="red";try{navigator.geolocation.watchPosition(findBuffer)}catch(e){}}return currentLocation&circleLT250Added&circleGT250Added&circleLT250&circleGT250}},1e3),gps_Button=L.easyButton({id:"gps",position:"topleft",states:[{icon:iconGPS,stateName:"check-mark",onClick:function(e,t){try{navigator.geolocation.watchPosition(findBuffer)}catch(e){}null!=currentLocation[0]&&(googleSat_Button.removeFrom(t),osm_Button.removeFrom(t),planet_Button.removeFrom(t),myLayer_Button.removeFrom(t),filter_Button.removeFrom(t),miniMap.addTo(t),setTimeout(function(){miniMap.remove(),osm_Button.addTo(t),googleSat_Button.removeFrom(t),planet_Button.removeFrom(t),myLayer_Button.addTo(t),filter_Button.addTo(t)},2e3),accuracy<=50?(gps_Button.button.style.backgroundColor="green",t.setView(currentLocation,15)):accuracy>50&&accuracy<=250?(gps_Button.button.style.backgroundColor="yellow",circleLT250.addTo(t),t.fitBounds(circleLT250.getBounds()),setTimeout(function(){circleLT250.removeFrom(t)},200)):accuracy>250&&(gps_Button.button.style.backgroundColor="orange",circleGT250.addTo(t),t.fitBounds(circleGT250.getBounds()),setTimeout(function(){circleGT250.removeFrom(t)},200))),null==currentLocation[0]&&(gps_Button.button.style.backgroundColor="red")}}]});gps_Button.button.style.width="50px",gps_Button.button.style.height="50px",gps_Button.button.style.transitionDuration=".3s",gps_Button.button.style.backgroundColor="white",gps_Button.addTo(map);var rose=L.control.rose("rose",{position:"topleft",icon:"nautical",iSize:"medium",opacity:1});rose.addTo(map);var drawnItems=new L.FeatureGroup;map.addLayer(drawnItems);var editableLayers=new L.FeatureGroup;map.addLayer(editableLayers);editableLayers=new L.FeatureGroup;var options={position:"topright",draw:{polyline:{shapeOptions:{color:"black",weight:2}},polygon:{allowIntersection:!1,icon:new L.DivIcon({iconSize:new L.Point(10,10),className:"leaflet-div-icon",weight:5}),drawError:{color:"red"},shapeOptions:{color:"#00ff00",weight:1}},marker:{icon:markerIconLocalStorage,draggable:!1}},edit:{featureGroup:editableLayers,remove:!1,edit:{selectedPathOptions:{dashArray:"5, 30",fill:!0,fillColor:"#fe57a1",fillOpacity:.5,maintainColor:!0}},poly:{icon:new L.DivIcon({iconSize:new L.Point(12,12),className:"leaflet-div-icon leaflet-editing-icon my-custom-icon"})}}},drawControl=new L.Control.Draw(options);map.on(L.Draw.Event.CREATED,function(e){e.layerType;var t=e.layer;drawnItems.addLayer(t)}),function(){var e=L.Draw.Polyline.prototype._onTouch;L.Draw.Polyline.prototype._onTouch=function(t){if("mouse"!=t.originalEvent.pointerType&&"touch"!=t.originalEvent.pointerType)return e.call(this,t)}}();var mapCurrentBounds,mapCurrentZoom,mapCurrentCenter,drawPolygon=new L.Draw.Polygon(map,drawControl.options.draw.polygon),drawPolyline=new L.Draw.Polyline(map,drawControl.options.draw.polyline),drawMarker=new L.Draw.Marker(map,drawControl.options.draw.marker);document.getElementById("goBack2").style.display="none",document.getElementById("deleteLastVertex").style.display="none",document.getElementById("deleteAllVertexs").style.display="none",document.getElementById("deleteLastVertexLine").style.display="none",document.getElementById("deleteAllVertexsLine").style.display="none",document.getElementById("completeFeature").style.display="none",document.getElementById("map").style.display="initial",document.getElementById("polygon").style.display="initial",document.getElementById("polyline").style.display="initial",document.getElementById("point").style.display="initial",document.getElementById("Download").style.display="none",document.getElementById("Cancel").style.display="none",document.getElementById("DownloadButton").style.display="none",document.getElementById("record").style.display="none",document.getElementById("enableRecording").style.display="none",document.getElementById("activatePlay").style.opacity="0",document.getElementById("storeAudio").style.display="none",document.getElementById("gum").style.display="none",document.getElementById("recorded").style.display="none",document.getElementById("echoCancellation").style.display="none",document.getElementById("voice").style.display="none",document.getElementById("Sent").style.display="none",document.getElementById("emoji").style.display="none",document.body.style.backgroundColor="white",document.getElementById("map").style.display="block",document.getElementById("tutorial").style.display="initial",document.getElementById("polygon").style.display="initial",document.getElementById("polyline").style.display="initial",document.getElementById("point").style.display="initial",document.getElementById("deleteLastVertex").style.opacity="0.35",document.getElementById("deleteLastVertex").disabled=!0,document.getElementById("deleteAllVertexs").style.opacity="0.35",document.getElementById("deleteAllVertexs").disabled=!0,document.getElementById("deleteLastVertexLine").style.opacity="0.35",document.getElementById("deleteLastVertexLine").disabled=!0,document.getElementById("deleteAllVertexsLine").style.opacity="0.35",document.getElementById("deleteAllVertexsLine").disabled=!0,document.getElementById("completeFeature").style.opacity="0.35",document.getElementById("completeFeature").disabled=!0,document.getElementById("tutorial").onclick=function(e){return mapCurrentBounds=map.getBounds(),mapCurrentZoom=map.getZoom(),mapCurrentCenter=map.getCenter(),setTimeout(function(){document.getElementById("imageryAlert").style.display="none",window.location.href="pages/tutorial.html",document.body.style.backgroundColor="black",document.getElementById("map").style.display="none",document.getElementById("tutorial").style.display="none",document.getElementById("polygon").style.display="none",document.getElementById("polyline").style.display="none",document.getElementById("point").style.display="none"},200),mapCurrentBounds&mapCurrentZoom&mapCurrentCenter};var clickMapCount=0,clickDelVertCount=0;document.getElementById("goBack2").onclick=function(e){return gps_Button.button.style.opacity="1",gps_Button.button.disabled=!1,map.doubleClickZoom.enable(),"black"==myLayer_Button.button.style.backgroundColor&&(filter_Button.button.style.opacity="1",filter_Button.button.disabled=!1),clickMapCount=0,map.zoomOut(1),setTimeout(function(){document.getElementById("tutorial").style.display="initial",document.getElementById("goBack2").style.display="none",document.getElementById("polygon").style.display="initial",document.getElementById("polyline").style.display="initial",document.getElementById("point").style.display="initial",document.getElementById("deleteLastVertex").style.display="none",document.getElementById("deleteAllVertexs").style.display="none",document.getElementById("deleteLastVertex").style.opacity="0.35",document.getElementById("deleteLastVertex").disabled=!0,document.getElementById("deleteAllVertexs").style.opacity="0.35",document.getElementById("deleteAllVertexs").disabled=!0,document.getElementById("deleteLastVertexLine").style.display="none",document.getElementById("deleteAllVertexsLine").style.display="none",document.getElementById("deleteLastVertexLine").style.opacity="0.35",document.getElementById("deleteLastVertexLine").disabled=!0,document.getElementById("deleteAllVertexsLine").style.opacity="0.35",document.getElementById("deleteAllVertexsLine").disabled=!0,document.getElementById("completeFeature").style.display="none",document.getElementById("completeFeature").style.opacity="0.35",document.getElementById("completeFeature").disabled=!0},200),drawPolygon.disable(),drawPolyline.disable(),drawMarker.disable(),drawnItems.remove(),drawnItems.clearLayers(),featureType};var tempLayer,finalAreaHa2Decimals,finalAreaAcres2Decimals,finalLength2Decimals,typeOfFeature,drawingPoint=!1;document.getElementById("point").onclick=function(e){return filter_Button.button.style.opacity="0.4",filter_Button.button.disabled=!0,gps_Button.button.style.opacity="0.4",gps_Button.button.disabled=!0,0==isIOS&&(recordedBlobs=null),featureType="point",map.doubleClickZoom.disable(),currentZoom=map.getZoom(),drawMarker.enable(),setTimeout(function(){document.getElementById("imageryAlert").style.display="none",document.getElementById("tutorial").style.display="none",document.getElementById("polygon").style.display="none",document.getElementById("polyline").style.display="none",document.getElementById("point").style.display="none",document.getElementById("goBack2").style.display="initial"},200),(drawingPoint=!0)&&featureType},document.getElementById("polyline").onclick=function(e){return filter_Button.button.style.opacity="0.4",filter_Button.button.disabled=!0,gps_Button.button.style.opacity="0.4",gps_Button.button.disabled=!0,0==isIOS&&(recordedBlobs=null),featureType="polyline",map.doubleClickZoom.disable(),map.on("draw:drawvertex",function(e){$(".leaflet-div-icon").css({"background-color":"white","border-radius":"10px",height:"10px",width:"10px"})}),map.on("draw:drawvertex",function(e){$(".leaflet-div-icon.leaflet-interactive:last").css({"background-color":"#F905EA","border-radius":"25px",height:"15px",width:"15px"})}),currentZoom=map.getZoom(),clickMapCount=0,drawPolyline.enable(),setTimeout(function(){document.getElementById("imageryAlert").style.display="none",document.getElementById("tutorial").style.display="none",document.getElementById("polygon").style.display="none",document.getElementById("polyline").style.display="none",document.getElementById("point").style.display="none",document.getElementById("goBack2").style.display="initial",document.getElementById("deleteLastVertexLine").style.display="initial",document.getElementById("deleteAllVertexsLine").style.display="initial",document.getElementById("completeFeature").style.display="initial"},200),featureType},document.getElementById("polygon").onclick=function(e){return filter_Button.button.style.opacity="0.4",filter_Button.button.disabled=!0,gps_Button.button.style.opacity="0.4",gps_Button.button.disabled=!0,0==isIOS&&(recordedBlobs=null),featureType="polygon",map.doubleClickZoom.disable(),map.on("draw:drawvertex",function(e){$(".leaflet-div-icon").css({"background-color":"#DAFDC4","border-radius":"10px",height:"10px",width:"10px"})}),map.on("draw:drawvertex",function(e){$(".leaflet-div-icon.leaflet-interactive:first").css({"background-color":"#F905EA","border-radius":"25px",height:"15px",width:"15px"})}),currentZoom=map.getZoom(),clickMapCount=0,drawPolygon.enable(),setTimeout(function(){document.getElementById("imageryAlert").style.display="none",document.getElementById("tutorial").style.display="none",document.getElementById("polygon").style.display="none",document.getElementById("polyline").style.display="none",document.getElementById("point").style.display="none",document.getElementById("goBack2").style.display="initial",document.getElementById("deleteLastVertex").style.display="initial",document.getElementById("deleteAllVertexs").style.display="initial",document.getElementById("completeFeature").style.display="initial"},200),featureType},document.getElementById("map").onclick=function(e){0==created&&("polyline"==featureType&&drawPolyline._markers.length>0&&(document.getElementById("deleteLastVertexLine").style.opacity="1",document.getElementById("deleteLastVertexLine").disabled=!1),"polyline"==featureType&&drawPolyline._markers.length>1&&(document.getElementById("deleteAllVertexsLine").style.opacity="1",document.getElementById("deleteAllVertexsLine").disabled=!1,document.getElementById("completeFeature").style.opacity="1",document.getElementById("completeFeature").disabled=!1),"polygon"==featureType&&drawPolygon._markers.length>0&&(document.getElementById("deleteLastVertex").style.opacity="1",document.getElementById("deleteLastVertex").disabled=!1),"polygon"==featureType&&drawPolygon._markers.length>1&&(document.getElementById("deleteAllVertexs").style.opacity="1",document.getElementById("deleteAllVertexs").disabled=!1),"polygon"==featureType&&drawPolygon._markers.length>2&&(document.getElementById("completeFeature").style.opacity="1",document.getElementById("completeFeature").disabled=!1))},document.getElementById("deleteLastVertex").onclick=function(e){1==drawPolygon._markers.length?(document.getElementById("deleteAllVertexs").disabled=!1,document.getElementById("deleteAllVertexs").click()):drawPolygon._markers.length>1&&drawPolygon.deleteLastVertex(),drawPolygon._markers.length<3&&(document.getElementById("completeFeature").style.opacity="0.35",document.getElementById("completeFeature").disabled=!0),drawPolygon._markers.length<2&&(document.getElementById("deleteAllVertexs").style.opacity="0.35",document.getElementById("deleteAllVertexs").disabled=!0)},document.getElementById("deleteAllVertexs").onclick=function(e){clickMapCount=0,drawPolygon.disable(),drawPolygon.enable(),setTimeout(function(){document.getElementById("deleteLastVertex").style.opacity="0.35",document.getElementById("deleteLastVertex").disabled=!0,document.getElementById("deleteAllVertexs").style.opacity="0.35",document.getElementById("deleteAllVertexs").disabled=!0,document.getElementById("completeFeature").style.opacity="0.35",document.getElementById("completeFeature").disabled=!0},200)},document.getElementById("deleteLastVertexLine").onclick=function(e){1==drawPolyline._markers.length?(document.getElementById("deleteAllVertexsLine").disabled=!1,document.getElementById("deleteAllVertexsLine").click()):drawPolyline._markers.length>1&&drawPolyline.deleteLastVertex(),1==drawPolyline._markers.length&&(document.getElementById("completeFeature").style.opacity="0.35",document.getElementById("completeFeature").disabled=!0,document.getElementById("deleteAllVertexsLine").style.opacity="0.35",document.getElementById("deleteAllVertexsLine").disabled=!0)},document.getElementById("deleteAllVertexsLine").onclick=function(e){drawPolyline.disable(),drawPolyline.enable(),setTimeout(function(){document.getElementById("deleteLastVertexLine").style.opacity="0.35",document.getElementById("deleteLastVertexLine").disabled=!0,document.getElementById("deleteAllVertexsLine").style.opacity="0.35",document.getElementById("deleteAllVertexsLine").disabled=!0,document.getElementById("completeFeature").style.opacity="0.35",document.getElementById("completeFeature").disabled=!0},200)},document.getElementById("completeFeature").onclick=function(e){"polyline"==featureType?drawPolyline.completeShape():"polygon"==featureType&&drawPolygon.completeShape()},map.on("draw:deleted",function(e){self.drawControlEdit.remove(),self.drawControlFull.addTo(map)}),map.on("draw:created",function(e){myLayer_Button.button.style.opacity="0.4",myLayer_Button.button.disabled=!0;try{deflated.removeFrom(map),localStorageLayer.removeFrom(map),drawnItems.removeFrom(map)}catch(e){}created=!0,drawPolygon.disable(),document.getElementById("deleteAllVertexs").style.display="none",document.getElementById("deleteLastVertex").style.display="none",document.getElementById("goBack2").style.display="none",document.getElementById("deleteLastVertexLine").style.display="none",document.getElementById("deleteAllVertexsLine").style.display="none",document.getElementById("completeFeature").style.display="none",document.getElementById("share-download").style.display="initial",document.getElementById("share-download").style.opacity="0.35",document.getElementById("share-download").disabled=!0,document.getElementById("Cancel").style.display="initial",document.getElementById("classification").style.display="initial",document.getElementById("emoji").style.display="initial",document.getElementById("emoji").disabled=!1,document.getElementById("emoji").style.opacity="1",document.getElementById("Sent").currentTime=0,document.getElementById("voice").style.display="none",document.getElementById("voice").style.opacity="0",0==isIOS?document.getElementById("enableRecording").style.display="initial":document.getElementById("noAudioIOS").style.display="initial",document.getElementById("emoji").style.display="initial",data=drawnItems.toGeoJSON();var t=e.layerType;if("polygon"==t){typeOfFeature="polygon";var n=1e-4*finalArea,o=247105e-9*finalArea;finalAreaHa2Decimals=n.toFixed(2)+" hectares",finalAreaAcres2Decimals=o.toFixed(2)+" acres",document.getElementById("showAreaHa").style.display="initial",document.getElementById("showAreaHa").innerHTML=finalAreaHa2Decimals,document.getElementById("showAreaAcres").style.display="initial",document.getElementById("showAreaAcres").innerHTML=finalAreaAcres2Decimals}"polyline"==t&&(typeOfFeature="polyline",finalLength2Decimals=finalLength.toFixed(2)+" meters",document.getElementById("showLength").innerHTML=finalLength2Decimals),"point"==featureType&&setTimeout(function(){map.zoomOut(3)},100),tempLayer=L.geoJSON(data,{pointToLayer:function(e,t){return L.marker(t,{icon:markerIconLocalStorage,draggable:!1})},style:function(e){return e.properties&&e.properties.style},color:"#ffff00",icon:markerIconLocalStorage,onEachFeature:function(e,t){t.bindPopup("...").addTo(map),t.bindPopup("...").openPopup()}}).addTo(map);drawnItems.getBounds().getCenter(),map.getBounds();return map.fitBounds(drawnItems.getBounds(),{paddingBottomRight:[0,0]}),document.getElementsByClassName("emojionearea-editor")[0].innerHTML=null,document.getElementsByClassName("emojionearea-wrapper").innerHTML=null,startCheckingText(),created&data&&typeOfFeature});var refreshPopup,boxContent,windowWidth=window.innerWidth,windowHeight=window.innerHeight,screenwidth=screen.width,screenwithWithMargins=.3*screenwidth,screenheight=screen.height,alreadyMovedUp=!1,moveMaptoTop=function(){alreadyMovedUp=!0;map.getBounds();var e=[screenwidth/2,screenheight/2*1.3],t=map.containerPointToLatLng(e);if(screenwidth<600)return map.panTo(t),alreadyMovedUp},startCheckingText=function(){var e="...";return tempLayer.removeFrom(map),(tempLayer=L.geoJSON(data,{pointToLayer:function(e,t){return L.marker(t,{icon:markerIconLocalStorage,draggable:!1})},style:function(e){return e.properties&&e.properties.style},color:"#ffff00",onEachFeature:function(t,n){refreshPopup=setInterval(function(){var t=document.getElementsByClassName("emojionearea-editor")[0].innerHTML;0==t.length?(n.bindPopup(e).addTo(map),n.bindPopup(e).openPopup(),0==audioRecorded&&(document.getElementById("share-download").style.opacity="0.35",document.getElementById("share-download").disabled=!0)):(n.bindPopup(t).addTo(map),n.bindPopup(t).openPopup(),document.getElementById("share-download").style.opacity="1",document.getElementById("share-download").disabled=!1)},500)}}).addTo(map))&&refreshPopup};function stopAudioAutomatically(){"yellow"==document.getElementById("record").style.backgroundColor&&setTimeout(function(){"yellow"==document.getElementById("record").style.backgroundColor&&document.getElementById("record").click()},3e4)}document.getElementById("noAudioIOS").onclick=function(e){"e"==browserLanguage[0]&&"n"==browserLanguage[1]&&alert("ðŸš§ Voice recording not yet available for iPhone,iPad or Mac."),"e"==browserLanguage[0]&&"s"==browserLanguage[1]&&alert("ðŸš§ La grabaciÃ³n de voz aÃºn no estÃ¡ disponible para iPhone, iPad o Mac."),"p"==browserLanguage[0]&&"t"==browserLanguage[1]&&alert("ðŸš§ A gravaÃ§Ã£o de voz ainda nÃ£o estÃ¡ disponÃ­vel para iPhone, iPad ou Mac."),"f"==browserLanguage[0]&&"r"==browserLanguage[1]&&alert("ðŸš§ L'enregistrement vocal n'est pas encore disponible pour iPhone, iPad ou Mac."),"sw"==browserLanguage&&alert("ðŸš§ Kurekodi kwa sauti bado haipatikani kwa iPhone, iPad au Mac.")},0==isIOS&&(document.getElementById("enableRecording").onclick=function(e){setTimeout(function(){document.getElementById("record").style.display="initial",document.getElementById("record").style.opacity="1",document.getElementById("enableRecording").style.display="none"},200)}),document.getElementById("record").onclick=function(e){if(0==recording){document.getElementById("voiceGif").play(),this.style.backgroundColor="yellow",this.style.borderColor="yellow",document.getElementById("activatePlay").style.display="none",document.getElementById("storeAudio").style.opacity="0.1",document.getElementById("emoji").style.display="none",document.getElementById("voice").style.display="initial",document.getElementById("voice").style.opacity="1";window.innerWidth;190,"px",stopAudioAutomatically()}return 1==recording&&(audioRecorded=!0,document.getElementById("share-download").style.opacity="1",document.getElementById("share-download").disabled=!1,this.style.backgroundColor="white",document.getElementById("voiceGif").pause(),document.getElementById("activatePlay").style.display="initial",document.getElementById("activatePlay").style.opacity="1",document.getElementById("storeAudio").style.opacity="1",document.getElementById("emoji").style.display="initial",document.getElementById("voice").style.display="none",document.getElementById("voice").style.opacity="0",audioStoppedManually=!0),document.getElementById("gum").style.display="none",document.getElementById("recorded").style.display="none",document.getElementById("echoCancellation").style.display="none",audioRecorded},document.getElementById("activatePlay").onclick=function(e){document.getElementById("play").click(),document.getElementById("activatePlay").style.background="grey",setTimeout(function(){document.getElementById("activatePlay").style.background="white"},500)},$("#emojionearea").emojioneArea({pickerPosition:"top",filtersPosition:"bottom",tones:!1,autocomplete:!1,inline:!1,hidePickerOnBlur:!1,search:!1,placeholder:"..."}),document.getElementById("Cancel").onclick=function(e){return document.getElementsByClassName("emojionearea-editor")[0].innerHTML=null,myLayer_Button.button.style.opacity="1",myLayer_Button.button.disabled=!1,myLayer_Button.button.style.backgroundColor="grey",gps_Button.button.style.opacity="1",gps_Button.button.disabled=!1,"black"==myLayer_Button.button.style.backgroundColor&&(filter_Button.button.style.opacity="1",filter_Button.button.disabled=!1),featureType="initial",alreadyMovedUp=!1,audioRecorded=!1,typeOfFeature=null,clearInterval(refreshPopup),map.doubleClickZoom.enable(),created=!1,drawnItems.remove(),drawnItems.clearLayers(),map.zoomOut(1),drawingPoint=!1,0==isIOS&&(recordedVideo.pause(),recordedBlobs=null),setTimeout(function(){document.getElementById("tutorial").style.display="initial",document.getElementById("polygon").style.display="initial",document.getElementById("polyline").style.display="initial",document.getElementById("point").style.display="initial",document.getElementById("Cancel").style.display="none",document.getElementById("Download").style.display="none",document.getElementById("DownloadButton").style.display="none",document.getElementById("record").style.display="none",document.getElementById("enableRecording").style.display="none",document.getElementById("noAudioIOS").style.display="none",document.getElementById("activatePlay").style.display="none",document.getElementById("voice").style.display="none",document.getElementById("emoji").style.display="none",document.getElementById("showAreaHa").style.display="none",document.getElementById("showAreaAcres").style.display="none",document.getElementById("showLength").style.display="none",document.getElementById("share-download").style.display="none"},200),tempLayer.clearLayers(),created&featureType};var filesLength,storage,percentage,finalUrlAudio,files=[],finalPercentage=[];function onEachFeature(e,t){setTimeout(function(){if(0==isIOS&&null!=recordedBlobs)if(1==isOnline){clickableFinalUrlAudio="ðŸ”Š AUDIO".link(finalUrlAudio);var n=e.properties.landUsesEmoji+"</br></br>â³..."+clickableFinalUrlAudio}else n=e.properties.landUsesEmoji+"</br></br>â³...AUDIO";else n=e.properties.landUsesEmoji;e.properties&&e.properties.popupContent&&(n+=e.properties.popupContent),t.bindPopup(n).addTo(map),t.bindPopup(n).openPopup()},1600)}0==isIOS&&(document.getElementById("sendFirebase").onclick=function(e){for(let e=1;e<filesLength;e++){(storage=firebase.storage().ref(files[e].name)).put(files[e]).on("state_changed",function(t){return percentage=t.bytesTransferred/t.totalBytes*100,document.getElementById("progress").value=percentage,finalPercentage[e]=percentage,finalPercentage})}setTimeout(function(){null!=recordedBlobs&&firebase.storage().ref(files[1].name).getDownloadURL().then(function(e){return finalUrlAudio=e})},1e3)});var convertedData,data,dataGeometry,blob,dateTimeRandomID,timeFinish,diffTimes,timeOfVideo,finished=!1;function onEachFeatureAudioLocalStorage(e,t){setTimeout(function(){if(1==e.properties.audioAvailable)var n=e.properties.landUsesEmoji+"</br></br>ðŸ”Š AUDIO";else n=e.properties.landUsesEmoji;e.properties&&e.properties.popupContent&&(n+=e.properties.popupContent),t.bindPopup(n),1==finished&&t.bindPopup(n).openPopup()},1600)}document.getElementById("share-download").onclick=function(e){sameSession=!0,alreadyMovedUp=!1,audioRecorded=!1,typeOfFeature=null,drawingPoint=!1,clearInterval(refreshPopup);window.location.href;var t=Math.random();t*=1e4;var n=Math.round(t),o=new Date,l=o.getFullYear()+" "+(o.getMonth()+1)+" "+o.getDate()+" - "+(o.getHours()+" "+o.getMinutes()+" "+o.getSeconds()),a=Math.abs(timeStart-o)/1e3,i=a%60+60*(Math.floor(a/60)%60);if(null!=currentLocation[0]){currentLocation.toString();featureApproxLocation=map.getCenter();var d=L.latLng(featureApproxLocation),r=L.latLng(currentLocation),s=d.distanceTo(r),m=100*Math.random()*s,y=Math.trunc(m)}else y="Location not recorded";(dateTimeRandomID="Date&time: "+l+" RandomID:"+n).toString(),data=drawnItems.toGeoJSON(),dataGeometry=data.features[0].geometry;[1].filter(e=>null!=e).toString();boxContent=document.getElementById("emojionearea").value;var c=emojione.toShort(boxContent).toString();if(null==finalAreaHa2Decimals&&null==finalLength2Decimals&&(finalAreaHa2Decimals="Point",finalLength2Decimals="Point"),null!=finalAreaHa2Decimals&&null==finalLength2Decimals&&(finalLength2Decimals="Polygon"),null==finalAreaHa2Decimals&&null!=finalLength2Decimals&&(finalAreaHa2Decimals="Line"),0==isIOS&&null!=recordedBlobs)var u=!0;else u=!1;var p={landUses:c,landUsesEmoji:boxContent,audioAvailable:u,areaPolygon:finalAreaHa2Decimals,lengthLine:finalLength2Decimals,dateTime:l,timeSpendSeconds:i,dist_m_Participant_Feature:y,randomID:n,geometrystring:data.toString()};data.features[0].properties=p,convertedData="text/json;charset=utf-8,"+encodeURIComponent(JSON.stringify(data)),0==isIOS&&null!=recordedBlobs&&(blob=new Blob(recordedBlobs,{type:"audio/webm"})),setTimeout(function(){drawnItems.clearLayers(),tempLayer.clearLayers(),document.getElementById("map").style.height="0px",document.getElementById("Cancel").style.display="none",document.getElementById("share-download").style.display="none",document.getElementById("noAudioIOS").style.display="none",document.getElementById("record").style.display="none",document.getElementById("enableRecording").style.display="none",document.getElementById("play").style.display="none",document.getElementById("voice").style.display="none",document.getElementById("voice").style.opacity="0",document.getElementById("activatePlay").style.display="none",document.getElementById("showAreaHa").style.display="none",document.getElementById("showAreaAcres").style.display="none",document.getElementById("showLength").style.display="none",document.getElementById("emoji").style.display="none",document.getElementById("shareWorldButton").style.display="initial",document.getElementById("DownloadButton").style.display="initial",document.getElementById("Download").style.display="initial",document.body.style.backgroundColor="black"},200),recordedVideo.pause(),recordedVideo.currentTime=0,created=!1;var g=JSON.stringify(data),B=n;localStorage.setItem(B,g);myLayerIsOn=!0,myLayer_Button.button.style.backgroundColor="black";var I,E,f="geojson "+dateTimeRandomID;return 0==isIOS&&null!=recordedBlobs&&(audioBlobFile=(E="audio "+dateTimeRandomID,(I=blob).lastModifiedDate=new Date,I.name=E,I)),featureType=null,dataFile=new File([g],f,{type:"application/json"}),0==isIOS&&null!=recordedBlobs?(files=[dataFile,audioBlobFile],filesLength=2):(files=[dataFile],filesLength=1),created&&data&&myLayerIsOn&&files&&filesLength&&convertedData&&blob&&sameSession&&featureType},timeOfVideo=0==isIOS?2800:3400,document.getElementById("shareWorldButton").onclick=function(e){if(1==isOnline){setTimeout(function(){document.getElementById("shareWorldButton").style.display="none",document.getElementById("DownloadButton").style.display="none",document.getElementById("Sent").style.display="initial",document.getElementById("sentVideo").play(),document.getElementById("sentVideo").controls=!1,document.body.style.backgroundColor="white",document.getElementById("sendFirebase").click()},200),setTimeout(function(){if(document.getElementById("Sent").style.display="none",document.getElementById("uploading").style.display="none",document.getElementById("progress").style.display="none",document.getElementById("deleteAllVertexs").style.opacity="0.35",document.getElementById("deleteAllVertexs").disabled=!0,document.getElementById("deleteAllVertexsLine").style.opacity="0.35",document.getElementById("deleteAllVertexsLine").disabled=!0,document.getElementById("completeFeature").style.opacity="0.35",document.getElementById("completeFeature").disabled=!0,document.body.style.backgroundColor="white",document.getElementById("map").style.height="100%",document.getElementById("tutorial").style.display="initial",document.getElementById("polygon").style.display="initial",document.getElementById("polyline").style.display="initial",document.getElementById("point").style.display="initial",propertiesGeoJSON=data.features[0].properties,landUses=propertiesGeoJSON.landUses,landUsesEmoji=propertiesGeoJSON.landUsesEmoji,null!=finalUrlAudio){audioAvailable=finalUrlAudio}else audioAvailable=".";areaPolygon=propertiesGeoJSON.areaPolygon,lengthLine=propertiesGeoJSON.lengthLine,dateTime=propertiesGeoJSON.dateTime,timeSpendSeconds=propertiesGeoJSON.timeSpendSeconds,dist_m_Participant_Feature=propertiesGeoJSON.dist_m_Participant_Feature,randomID=propertiesGeoJSON.randomID,setData(),finalLayer=L.geoJSON(data,{style:function(e){return e.properties&&e.properties.style},color:"#0CACDF",onEachFeature:onEachFeature}).addTo(map)},timeOfVideo),osm_Button.addTo(map),myLayer_Button.addTo(map),filter_Button.addTo(map),myLayer_Button.button.style.opacity="1",myLayer_Button.button.disabled=!1,filter_Button.button.style.opacity="1",filter_Button.button.disabled=!1,gps_Button.button.style.opacity="1",gps_Button.button.disabled=!1,document.getElementsByClassName("emojionearea-editor")[0].innerHTML=null;try{localStorageLayer.removeFrom(map)}catch(e){}return deflated.addTo(map),finalAreaHa2Decimals=null,finalLength2Decimals=null,(featureSent=!0)&&finalAreaHa2Decimals&&finalLength2Decimals}alert("ðŸ›‘ You are offline")},document.getElementById("DownloadButton").onclick=function(e){return document.getElementById("downloadedVideo").play(),document.getElementById("downloadedVideo").controls=!1,document.getElementById("shareWorldButton").style.display="none",document.getElementById("DownloadButton").style.display="none",document.getElementById("Downloaded").style.display="initial",document.getElementById("Download").setAttribute("href","data:"+convertedData),document.getElementById("Download").setAttribute("download",dateTimeRandomID),document.body.style.backgroundColor="white",finished=!0,setTimeout(function(){document.getElementById("Downloaded").style.display="none",document.getElementById("uploading").style.display="none",document.getElementById("progress").style.display="none",document.getElementById("deleteAllVertexs").style.opacity="0.35",document.getElementById("deleteAllVertexs").disabled=!0,document.getElementById("deleteAllVertexsLine").style.opacity="0.35",document.getElementById("deleteAllVertexsLine").disabled=!0,document.getElementById("completeFeature").style.opacity="0.35",document.getElementById("completeFeature").disabled=!0,document.body.style.backgroundColor="white",document.getElementById("map").style.height="100%",document.getElementById("tutorial").style.display="initial",document.getElementById("polygon").style.display="initial",document.getElementById("polyline").style.display="initial",document.getElementById("point").style.display="initial",myLayer_Button.button.style.opacity="1",myLayer_Button.button.disabled=!1,filter_Button.button.style.opacity="0.4",filter_Button.button.disabled=!0,gps_Button.button.style.opacity="1",gps_Button.button.disabled=!1,document.getElementsByClassName("emojionearea-editor")[0].innerHTML=null,finalLayer=L.geoJSON(data,{style:function(e){return e.properties&&e.properties.style},color:"#0CACDF",onEachFeature:onEachFeatureAudioLocalStorage}).addTo(map)},timeOfVideo-300),finished};
